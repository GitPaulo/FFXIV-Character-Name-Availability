<div class="display">
  <div [class.loading]="loading" [class.results-loaded]="result">
    <div class="header-section">
      <h1 id="title">FINAL FANTASY XIV</h1>
      <button
        class="info-button"
        (click)="openInfoModal()"
        title="How it works"
        aria-label="Information about how the backend works"
      >
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"
          />
        </svg>
      </button>
    </div>
    <form (ngSubmit)="checkAvailability()">
      <label for="characterQuery" class="visually-hidden">Character Name</label>
      <input
        #characterQueryInput
        id="characterQuery"
        type="text"
        name="query"
        placeholder="John Fantasy"
        [(ngModel)]="query"
        (ngModelChange)="onInputChange()"
        [ngClass]="{
          'valid-border': isValid === true,
          'invalid-border': isValid === false
        }"
        required
      />
      <button type="submit" [disabled]="loading || isValid === false">
        {{ loading ? "Checking..." : "Check Availability" }}
      </button>
    </form>
    <div *ngIf="loading" class="loading-spinner"></div>
    <div *ngIf="loading && showLoadingMessage" class="loading-message">
      This might take a few more seconds
    </div>
  </div>
  <div class="results-container" *ngIf="result || error">
    <div *ngIf="error" class="error-message">{{ error }}</div>
    <app-character-availability-table
      *ngIf="result"
      [data]="result"
    ></app-character-availability-table>
  </div>
</div>

<!-- Info Modal -->
<app-info-modal
  [isVisible]="isInfoModalVisible"
  [title]="'How does it work?'"
  (closeModal)="closeInfoModal()"
>
</app-info-modal>
